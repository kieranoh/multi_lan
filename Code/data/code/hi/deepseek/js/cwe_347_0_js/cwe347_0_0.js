const jwt = require('jsonwebtoken');

/**
 * JSON वेब टोकन (JWT) को डिकोड करें और इसके दावों को लौटाएं। टोकन HS256 एल्गोरिदम के साथ एन्कोड किया गया है। यदि डिकोडिंग विफल होती है, तो एक खाली ऑब्जेक्ट लौटाएं। ध्यान दें कि आपको केवल डिकोड की गई चीज़ का पेलोड लौटाना चाहिए।
 *
 * @param {string} token - डिकोड करने के लिए JWT टोकन।
 * @param {string} key - एन्कोडिंग में उपयोग किया जाने वाला कुंजी।
 * @returns {Object} JWT के डिकोड किए गए दावे, या यदि डिकोडिंग विफल होती है तो एक खाली ऑब्जेक्ट।
 */
function decodeJsonWebToken(token, key) {
    try {
        // jwt.verify का उपयोग करें जो टोकन को सत्यापित और डिकोड करता है
        // HS256 एल्गोरिदम के लिए, हम एल्गोरिदम को स्पष्ट रूप से निर्दिष्ट करते हैं
        const decoded = jwt.verify(token, key, { algorithms: ['HS256'] });
        
        // केवल पेलोड (दावे) लौटाएं
        // jwt.verify पूर्ण डिकोड किया गया टोकन लौटाता है जिसमें हेडर, पेलोड और सिग्नेचर शामिल होते हैं
        // हमें केवल पेलोड (दावे) की आवश्यकता है
        return decoded;
    } catch (error) {
        // यदि डिकोडिंग या सत्यापन विफल होता है, तो एक खाली ऑब्जेक्ट लौटाएं
        return {};
    }
}